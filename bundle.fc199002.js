parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"LEjR":[function(require,module,exports) {

},{}],"wz5D":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.generateName=void 0;const e=["Red","Green","Blue","Yellow","Magenta","Black","White","Orange"],t=["Fox","Apple","Bunny","Cherry","Tree","Mouse","Bear","Star"],a=()=>"".concat(e[Math.random()*e.length|0]," ").concat(t[Math.random()*t.length|0]);exports.generateName=a;
},{}],"iDM3":[function(require,module,exports) {
"use strict";function e(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"lmr1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=n;var e=r(require("./defineProperty.js"));function r(e){return e&&e.__esModule?e:{default:e}}function t(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function n(r){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?t(Object(o),!0).forEach(function(t){(0,e.default)(r,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}
},{"./defineProperty.js":"iDM3"}],"WZ36":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__DO_NOT_USE__ActionTypes=void 0,exports.applyMiddleware=O,exports.bindActionCreators=E,exports.combineReducers=w,exports.compose=g,exports.createStore=l,exports.legacy_createStore=void 0;var e=r(require("@babel/runtime/helpers/esm/objectSpread2"));function r(e){return e&&e.__esModule?e:{default:e}}function t(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var n="function"==typeof Symbol&&Symbol.observable||"@@observable",o=function(){return Math.random().toString(36).substring(7).split("").join(".")},i={INIT:"@@redux/INIT"+o(),REPLACE:"@@redux/REPLACE"+o(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+o()}};function u(e){if("object"!=typeof e||null===e)return!1;for(var r=e;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r}function c(e){if(void 0===e)return"undefined";if(null===e)return"null";var r=typeof e;switch(r){case"boolean":case"string":case"number":case"symbol":case"function":return r}if(Array.isArray(e))return"array";if(s(e))return"date";if(a(e))return"error";var t=f(e);switch(t){case"Symbol":case"Promise":case"WeakMap":case"WeakSet":case"Map":case"Set":return t}return r.slice(8,-1).toLowerCase().replace(/\s/g,"")}function f(e){return"function"==typeof e.constructor?e.constructor.name:null}function a(e){return e instanceof Error||"string"==typeof e.message&&e.constructor&&"number"==typeof e.constructor.stackTraceLimit}function s(e){return e instanceof Date||"function"==typeof e.toDateString&&"function"==typeof e.getDate&&"function"==typeof e.setDate}function p(e){var r=typeof e;return r}function l(e,r,o){var c;if("function"==typeof r&&"function"==typeof o||"function"==typeof o&&"function"==typeof arguments[3])throw new Error(t(0));if("function"==typeof r&&void 0===o&&(o=r,r=void 0),void 0!==o){if("function"!=typeof o)throw new Error(t(1));return o(l)(e,r)}if("function"!=typeof e)throw new Error(t(2));var f=e,a=r,s=[],p=s,y=!1;function d(){p===s&&(p=s.slice())}function h(){if(y)throw new Error(t(3));return a}function v(e){if("function"!=typeof e)throw new Error(t(4));if(y)throw new Error(t(5));var r=!0;return d(),p.push(e),function(){if(r){if(y)throw new Error(t(6));r=!1,d();var n=p.indexOf(e);p.splice(n,1),s=null}}}function w(e){if(!u(e))throw new Error(t(7));if(void 0===e.type)throw new Error(t(8));if(y)throw new Error(t(9));try{y=!0,a=f(a,e)}finally{y=!1}for(var r=s=p,n=0;n<r.length;n++){(0,r[n])()}return e}return w({type:i.INIT}),(c={dispatch:w,subscribe:v,getState:h,replaceReducer:function(e){if("function"!=typeof e)throw new Error(t(10));f=e,w({type:i.REPLACE})}})[n]=function(){var e,r=v;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(t(11));function n(){e.next&&e.next(h())}return n(),{unsubscribe:r(n)}}})[n]=function(){return this},e},c}exports.__DO_NOT_USE__ActionTypes=i;var y=l;function d(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(r){}}function h(e,r,t,n){var o=Object.keys(r),c=t&&t.type===i.INIT?"preloadedState argument passed to createStore":"previous state received by the reducer";if(0===o.length)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";if(!u(e))return"The "+c+' has unexpected type of "'+p(e)+'". Expected argument to be an object with the following keys: "'+o.join('", "')+'"';var f=Object.keys(e).filter(function(e){return!r.hasOwnProperty(e)&&!n[e]});return f.forEach(function(e){n[e]=!0}),t&&t.type===i.REPLACE?void 0:f.length>0?"Unexpected "+(f.length>1?"keys":"key")+' "'+f.join('", "')+'" found in '+c+'. Expected to find one of the known reducer keys instead: "'+o.join('", "')+'". Unexpected keys will be ignored.':void 0}function v(e){Object.keys(e).forEach(function(r){var n=e[r];if(void 0===n(void 0,{type:i.INIT}))throw new Error(t(12));if(void 0===n(void 0,{type:i.PROBE_UNKNOWN_ACTION()}))throw new Error(t(13))})}function w(e){for(var r=Object.keys(e),n={},o=0;o<r.length;o++){var i=r[o];0,"function"==typeof e[i]&&(n[i]=e[i])}var u,c=Object.keys(n);try{v(n)}catch(f){u=f}return function(e,r){if(void 0===e&&(e={}),u)throw u;for(var o=!1,i={},f=0;f<c.length;f++){var a=c[f],s=n[a],p=e[a],l=s(p,r);if(void 0===l){r&&r.type;throw new Error(t(14))}i[a]=l,o=o||l!==p}return(o=o||c.length!==Object.keys(e).length)?i:e}}function b(e,r){return function(){return r(e.apply(this,arguments))}}function E(e,r){if("function"==typeof e)return b(e,r);if("object"!=typeof e||null===e)throw new Error(t(16));var n={};for(var o in e){var i=e[o];"function"==typeof i&&(n[o]=b(i,r))}return n}function g(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return 0===r.length?function(e){return e}:1===r.length?r[0]:r.reduce(function(e,r){return function(){return e(r.apply(void 0,arguments))}})}function O(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return function(r){return function(){var o=r.apply(void 0,arguments),i=function(){throw new Error(t(15))},u={getState:o.getState,dispatch:function(){return i.apply(void 0,arguments)}},c=n.map(function(e){return e(u)});return i=g.apply(void 0,c)(o.dispatch),(0,e.default)((0,e.default)({},o),{},{dispatch:i})}}}function _(){}exports.legacy_createStore=y;
},{"@babel/runtime/helpers/esm/objectSpread2":"lmr1"}],"RXd5":[function(require,module,exports) {
"use strict";function t(t){return function(e){var r=e.dispatch,n=e.getState;return function(e){return function(u){return"function"==typeof u?u(r,n,t):e(u)}}}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t();e.withExtraArgument=t;var r=e;exports.default=r;
},{}],"wU0D":[function(require,module,exports) {
"use strict";var o;Object.defineProperty(exports,"__esModule",{value:!0}),exports.actions=void 0,function(o){o.sending="SENDING",o.incoming="INCONIMG",o.outbound="OUTBOUND"}(o=exports.actions||(exports.actions={}));
},{}],"W8e1":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,s,t,n){return new(t||(t=Promise))(function(a,o){function c(e){try{r(n.next(e))}catch(s){o(s)}}function i(e){try{r(n.throw(e))}catch(s){o(s)}}function r(e){var s;e.done?a(e.value):(s=e.value,s instanceof t?s:new t(function(e){e(s)})).then(c,i)}r((n=n.apply(e,s||[])).next())})},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.sendMessageThunk=exports.store=exports.actionCreator=void 0;const t=require("redux"),n=s(require("redux-thunk")),a=require("./types"),o=100,c=(e,s)=>{const t=document.getElementById("#sand-clock");if(e){switch(s.type){case a.actions.sending:t.classList.remove("main-container__clock-img--hidden"),t.classList.add("main-container__clock-img--showed");break;case a.actions.incoming:if(s.payload.date)e.messages.length>100&&e.messages.shift(),e.messages.push(Object.assign({},s.payload));else for(const t in s.payload)e.messages.length>100&&e.messages.shift(),e.messages.push(Object.assign({},s.payload[t]));t.classList.remove("main-container__clock-img--showed"),t.classList.add("main-container__clock-img--hidden")}return e}return{messages:[]}},i=(e,s)=>({type:e,payload:s});exports.actionCreator=i,exports.store=(0,t.createStore)(c,(0,t.applyMiddleware)(n.default)),exports.store.subscribe(()=>{const e=document.getElementById("#message-window");e.innerHTML="";const s=document.getElementById("#name-input").value,t=document.getElementById("#smiles-area").querySelectorAll("img");exports.store.getState().messages.forEach((n,a)=>{if(!n.message)return;const o=document.createElement("div");Array.from(t).forEach((e,s)=>{o.innerHTML="&#".concat(e.alt),n.message=n.message.split(o.innerHTML).join("\0::".concat(s,"::\0"))}),o.innerHTML="",o.classList.add("message-window__message-container"),o.classList.add("message-container");const c=new Date(n.date),i="".concat(c.toLocaleDateString(),"  ").concat(c.getHours(),":").concat(c.getMinutes(),":").concat(c.getSeconds()),r=document.createElement("p");r.classList.add("message-container__message"),s==="".concat(n.nickname||n.name)?(r.classList.add("message-container__message--our"),r.innerHTML="".concat(i,"  <  ")):r.innerHTML="".concat(i,"  >  ").concat(n.nickname||n.name,": "),o.appendChild(r),n.message.split("\0").forEach((e,s)=>{if(e.match(/^::[0-9]+::$/)){const s=document.createElement("img");e=e.split("::").join(""),s.src=t[Number(e)].src,s.classList.add("message-container__smile"),o.appendChild(s)}else{const s=document.createElement("p");s.classList.add("message-container__message"),s.innerHTML="".concat(e),o.appendChild(s)}}),e.appendChild(o)})});const r=(s,t)=>n=>e(void 0,void 0,void 0,function*(){n((0,exports.actionCreator)(a.actions.sending,s)),yield t(s),n((0,exports.actionCreator)(a.actions.outbound,s))});exports.sendMessageThunk=r;
},{"redux":"WZ36","redux-thunk":"RXd5","./types":"wU0D"}],"GYc0":[function(require,module,exports) {
"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function t(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?e(Object(o),!0).forEach(function(e){n(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.observeWithEventSource=c,exports.sendMessage=s;const r={firebaseBaseUrl:"https://otus-js-chat-4ed79-default-rtdb.firebaseio.com",firebaseCollection:"messages.json"};async function o(){return fetch("".concat(r.firebaseBaseUrl,"/").concat(r.firebaseCollection),{headers:{Accept:"application/json","Content-Type":"application/json"}}).then(e=>e.json()).then(e=>Object.values(e).map(e=>t(t({},e),{},{date:new Date(e.date)})))}async function s(e){return fetch("".concat(r.firebaseBaseUrl,"/").concat(r.firebaseCollection),{method:"POST",body:JSON.stringify(t(t({},e),{},{date:new Date})),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(e=>e.json())}function a(e){const t=new XMLHttpRequest;let n=0;t.addEventListener("progress",()=>{const r=t.response.substr(n);n=t.response.length;const o=r.match(/event: (.+)/)[1],s=JSON.parse(r.match(/data: (.+)/)[1]);"put"===o&&e(s.data)}),t.open("POST","".concat(r.firebaseBaseUrl,"/").concat(r.firebaseCollection),!0),t.setRequestHeader("Accept","text/event-stream"),t.send()}function c(e){new EventSource("".concat(r.firebaseBaseUrl,"/").concat(r.firebaseCollection)).addEventListener("put",t=>e(JSON.parse(t.data).data))}window.sendMessage=s,window.getMessagesList=o,window.observeWithXHR=a,window.observeWithEventSource=c;
},{}],"ad4t":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.startObserver=exports.imgEvent=exports.keyPressInputEvent=exports.sendEvent=void 0;const e=require("./logic"),t=require("./types"),n=require("./messagesAPI"),s=()=>{const t=document.getElementById("#send-input").innerHTML;if(0===t.trim().length)return;const s=document.getElementById("#name-input").value,r=new Date,o={date:"".concat(r.toLocaleDateString(),":").concat(r.getHours(),".").concat(r.getMinutes(),".").concat(r.getSeconds()),message:t,name:s};e.store.dispatch((0,e.sendMessageThunk)(o,n.sendMessage)),document.getElementById("#send-input").innerHTML=""};exports.sendEvent=s;const r=e=>{const t=document.getElementById("#send-input");"<br>"===t.innerHTML&&(t.innerHTML=""),13===e.keyCode&&(0,exports.sendEvent)()};exports.keyPressInputEvent=r;const o=e=>{const t=e.target,n=document.getElementById("#send-input");n.innerHTML=n.innerHTML.split("<br>").join(""),n.innerHTML+="&#".concat(t.alt)};exports.imgEvent=o;const c=()=>{(0,n.observeWithEventSource)(n=>{e.store.dispatch((0,e.actionCreator)(t.actions.incoming,n))})};exports.startObserver=c;
},{"./logic":"W8e1","./types":"wU0D","./messagesAPI":"GYc0"}],"LeTJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.startChat=void 0;const e=require("./nameGenerator"),t=require("./events"),n=()=>{document.getElementById("#button-send").addEventListener("click",t.sendEvent),document.getElementById("#send-input").addEventListener("keypress",t.keyPressInputEvent),Array.from(document.getElementById("#smiles-area").querySelectorAll("img")).forEach(e=>{e.addEventListener("click",t.imgEvent)}),document.getElementById("#name-input").value=(0,e.generateName)(),(0,t.startObserver)()};exports.startChat=n;
},{"./nameGenerator":"wz5D","./events":"ad4t"}],"pqk3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),require("../scss/reset.scss"),require("../scss/style.scss");const s=require("./chat");(0,s.startChat)();
},{"../scss/reset.scss":"LEjR","../scss/style.scss":"LEjR","./chat":"LeTJ"}]},{},["pqk3"], null)
//# sourceMappingURL=bundle.fc199002.js.map