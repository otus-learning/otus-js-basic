{"version":3,"sources":["src/prjConst.js","src/fetches.js","src/events.js","src/ui.js","src/forecast.js","src/Templater.ts","src/Component.ts","src/bundle.ts"],"names":["MAIN_CONTAINER_ID","BTN_ID","EDIT_ID","CBX_ID","MY_LOCATION_LON","MY_LOCATION_LAT","CITY_LIST","LS_CAPACITY","GEOCODER_URL_START","GEOCODER_URL_END","MAP_URL_START","MAP_URL_END","WEATHER_API_KEY","WEATHER_URL_START","WEATHER_URL_END","IP_WHOIS_URL","WEATHER_FETCH_ERR","getCoordinates","city","response","fetch","prjConst","json","getLocation","aClick","e","document","getElementById","value","target","innerHTML","click","btnClick","then","cityInfo","lat","lon","storage","localStorage","checked","setItem","cityStorageJSON","getItem","cityList","JSON","parse","isNeedAddToHistory","i","length","toLowerCase","shift","push","stringify","mainContainer","addHistoryLink","historyComponent","history","showFunc","mapComponent","forecastComponent","edtKeypress","keyCode","cities","setState","createUI","container","searchComponent","subscribeToEvents","className","id","forEach","el","navigator","geolocation","getCurrentPosition","coords","latitude","longitude","data","getWeather","url","ok","Promise","resolve","reject","showLocationInFrame","lonS","Number","latS","lonE","latE","list","weather","description","main","temp","humidity","wind","speed"],"mappings":"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","file":"bundle.914f32c2.js","sourceRoot":"..","sourcesContent":["export const MAIN_CONTAINER_ID = \"#forecast\";\nexport const BTN_ID = \"#btnId\";\nexport const EDIT_ID = \"#edtId\";\nexport const CBX_ID = \"#cbxId\";\n\nexport const MY_LOCATION_LON = \"myLocationLon\";\nexport const MY_LOCATION_LAT = \"myLocationLat\";\nexport const CITY_LIST = \"cityList\";\n\nexport const LS_CAPACITY = 10;\n\nexport const GEOCODER_URL_START = \"https://nominatim.openstreetmap.org/search/\";\nexport const GEOCODER_URL_END =\n  \"?format=json&addressdetails=1&limit=1&polygon_svg=1\";\nexport const MAP_URL_START =\n  \"https://www.openstreetmap.org/export/embed.html?bbox=\";\nexport const MAP_URL_END = \"&amp;layer=mapnik\";\nexport const WEATHER_API_KEY = \"542ffd081e67f4512b705f89d2a611b2\";\nexport const WEATHER_URL_START =\n  \"https://api.openweathermap.org/data/2.5/forecast?lang=ru&units=metric&\";\n//const WEATHER_URL_START = \"http://api.openweathermap.org/data/2.5/weather?lang=ru&units=metric&\"\nexport const WEATHER_URL_END = \"&cnt=24&appid=\" + WEATHER_API_KEY;\n//const WEATHER_URL_END = \"&appid=\" + WEATHER_API_KEY;\nexport const IP_WHOIS_URL = \"https://ipwho.is\";\n\nexport const WEATHER_FETCH_ERR = \"Ошибка получения данных\";\n","import * as prjConst from \"./prjConst\";\n\n//request to geocoder\nexport async function getCoordinates(city) {\n  let response = await /*window.*/ fetch(\n    `${prjConst.GEOCODER_URL_START}${city}${prjConst.GEOCODER_URL_END}`\n  );\n  return await response.json();\n}\n\n//request to ip whois\nexport async function getLocation() {\n  let response = await /*window.*/ fetch(prjConst.IP_WHOIS_URL);\n  return await response.json();\n}\n","import * as prjConst from \"./prjConst.js\";\nimport { getCoordinates } from \"./fetches.js\";\nimport { addHistoryLink } from \"./ui.js\";\n\nexport let aClick = (e) => {\n  document.getElementById(prjConst.EDIT_ID).value = e.target.innerHTML;\n  document.getElementById(prjConst.BTN_ID).click();\n};\n\nexport let btnClick = (/*e*/) => {\n  let city = document.getElementById(prjConst.EDIT_ID).value;\n  document.getElementById(prjConst.EDIT_ID).value = \"\";\n  getCoordinates(city).then((cityInfo) => {\n    let lat = cityInfo[0].lat;\n    let lon = cityInfo[0].lon;\n\n    let storage = /*window.*/ localStorage;\n    if (document.getElementById(prjConst.CBX_ID).checked) {\n      storage.setItem(prjConst.MY_LOCATION_LON, lon);\n      storage.setItem(prjConst.MY_LOCATION_LAT, lat);\n      document.getElementById(prjConst.CBX_ID).checked = false;\n    }\n\n    let cityStorageJSON = storage.getItem(prjConst.CITY_LIST);\n    let cityList = cityStorageJSON ? JSON.parse(cityStorageJSON) : [];\n    let isNeedAddToHistory = true;\n    for (let i = 0; i < cityList.length; i++) {\n      if (cityList[i].toLowerCase() === city.toLowerCase()) {\n        isNeedAddToHistory = false;\n        break;\n      }\n    }\n\n    if (isNeedAddToHistory) {\n      if (cityList.length === prjConst.LS_CAPACITY) {\n        cityList.shift();\n      }\n      cityList.push(city);\n      storage.setItem(prjConst.CITY_LIST, JSON.stringify(cityList));\n\n      let mainContainer = document.getElementById(prjConst.MAIN_CONTAINER_ID);\n      addHistoryLink(\n        city,\n        mainContainer.historyComponent,\n        mainContainer.history\n      );\n    }\n\n    let mainContainer = document.getElementById(prjConst.MAIN_CONTAINER_ID);\n    mainContainer.showFunc(\n      lat,\n      lon,\n      mainContainer.mapComponent,\n      mainContainer.forecastComponent\n    );\n  });\n};\n\nexport let edtKeypress = (e) => {\n  if (e.keyCode === 13) {\n    document.getElementById(prjConst.BTN_ID).click();\n  }\n};\n","import * as prjConst from \"./prjConst.js\";\nimport { getLocation } from \"./fetches.js\";\nimport { aClick, btnClick, edtKeypress } from \"./events.js\";\n\nexport let addHistoryLink = (city, historyComponent, history) => {\n  history.cities.length === prjConst.LS_CAPACITY && history.cities.shift();\n  history.cities.push(city);\n  historyComponent.setState(history);\n};\n\nexport let createUI = (\n  container,\n  showFunc,\n  searchComponent,\n  forecastComponent,\n  mapComponent,\n  historyComponent\n) => {\n  let history = { cities: [] };\n\n  searchComponent.subscribeToEvents(\"click@button.btn\", btnClick);\n  searchComponent.subscribeToEvents(\"keypress@text.edt\", edtKeypress);\n  historyComponent.subscribeToEvents(\"click@a.aClass\", aClick);\n\n  container.className = \"main-container\";\n  container.id = prjConst.MAIN_CONTAINER_ID;\n\n  //save show function for using in the events\n  container.showFunc = showFunc;\n  container.mapComponent = mapComponent;\n  container.forecastComponent = forecastComponent;\n  container.historyComponent = historyComponent;\n  container.history = history;\n\n  let storage = /*window.*/ localStorage;\n\n  let cityStorageJSON = storage.getItem(prjConst.CITY_LIST);\n  if (cityStorageJSON) {\n    let cityList = JSON.parse(cityStorageJSON);\n    cityList.forEach((el) => {\n      addHistoryLink(el, historyComponent, history);\n    });\n  }\n\n  if (storage.getItem(prjConst.MY_LOCATION_LON)) {\n    let lon = storage.getItem(prjConst.MY_LOCATION_LON);\n    let lat = storage.getItem(prjConst.MY_LOCATION_LAT);\n    showFunc(lat, lon, mapComponent, forecastComponent);\n  } else {\n    /*window.*/ navigator.geolocation.getCurrentPosition(\n      (geolocation) => {\n        let lat = geolocation.coords.latitude;\n        let lon = geolocation.coords.longitude;\n        storage.setItem(prjConst.MY_LOCATION_LON, lon);\n        storage.setItem(prjConst.MY_LOCATION_LAT, lat);\n        showFunc(lat, lon, mapComponent, forecastComponent);\n      },\n      (/*error*/) => {\n        getLocation().then((data) => {\n          let lat = data.latitude;\n          let lon = data.longitude;\n          storage.setItem(prjConst.MY_LOCATION_LON, lon);\n          storage.setItem(prjConst.MY_LOCATION_LAT, lat);\n          showFunc(lat, lon, mapComponent, forecastComponent);\n        });\n      }\n    );\n  }\n};\n","import * as prjConst from \"./prjConst.js\";\n\n//request to weather provider\nasync function getWeather(lat, lon) {\n  let url = `${prjConst.WEATHER_URL_START}lat=${lat}&lon=${lon}${prjConst.WEATHER_URL_END}`;\n  let response = await /*window.*/ fetch(url);\n  if (response.ok) {\n    return await response.json();\n  }\n  return new Promise((resolve, reject) => {\n    reject(\"-\");\n  });\n}\n\nexport let showLocationInFrame = async (\n  lat,\n  lon,\n  mapComponent,\n  forecastComponent\n) => {\n  mapComponent.setState({\n    lonS: `${Number(lon) - 0.05}`,\n    latS: `${Number(lat) - 0.05}`,\n    lonE: `${Number(lon) + 0.05}`,\n    latE: `${Number(lat) + 0.05}`,\n  });\n  try {\n    forecastComponent.setState(await getWeather(lat, lon));\n  } catch (e) {\n    forecastComponent.setState({\n      list: [\n        {\n          weather: [{ description: `${prjConst.WEATHER_FETCH_ERR}` }],\n          main: { temp: \"-\", humidity: \"-\" },\n          wind: { speed: \"-\" },\n        },\n      ],\n    });\n  }\n};\n","import { AbstractTemplater } from \"./AbstractTemplater\";\n\nexport class Templater implements AbstractTemplater {\n  constructor() {}\n\n  public fromTemplate(\n    template: string,\n    data: { [index: string]: any },\n    index?: number,\n    count?: number\n  ) {\n    const getProp = (path: string, data: any): any => {\n      const splitted = path.split(\".\");\n      const prop = data[splitted[0]];\n      if (splitted.length > 1) {\n        splitted.shift();\n        return getProp(splitted.join(\".\"), prop);\n      }\n      return prop;\n    };\n\n    //{{for ... as ...}} {{endfor}}\n    let re =\n      /\\{\\{\\s*for\\s*([\\w|.]+)\\s*as\\s*([\\w|.]+)\\s*\\}\\}(.*)\\{\\{\\s*endfor\\s*\\}\\}/g;\n    let finded = [...template.matchAll(re)];\n    if (finded.length) {\n      const matches = finded[0];\n      const prop = getProp(matches[1], data);\n      if (prop) {\n        const length = prop.length;\n        const list = prop.map((prop: any, index: number) => {\n          const data: { [index: string]: any } = {};\n\n          data[String(matches[2])] = prop;\n          return this.fromTemplate(String(matches[3]), data, index, length);\n        });\n        template = template.replace(matches[0], list.join(\" \"));\n      } else {\n        template = template.replace(matches[0], \"\");\n      }\n    }\n\n    //{{if ...}} {{endif}}\n    re =\n      /\\{\\{\\s*if\\s*((?:\\{Part\\})?\\w[\\w|.]*)\\s*(([=|!]=)\\s*([\\w:\"]*))?\\s*\\}\\}(.*?)\\{\\{\\s*endif\\s*\\}\\}/g;\n    finded = [...template.matchAll(re)];\n    if (finded.length) {\n      finded.forEach((matches) => {\n        let flag = false;\n        let idx = 5;\n        matches = matches.filter((el) => {\n          return el;\n        });\n        if (matches[1] === \"index\") {\n          //== !=\n          if (matches.length > 3) {\n            switch (matches[3]) {\n            case \"==\": {\n              switch (matches[4]) {\n              case \"First\":\n                index === 0 && (flag = true);\n                break;\n              case \"Last\":\n                index === (count !== undefined ? count : 0) - 1 &&\n                      (flag = true);\n                break;\n              default:\n                String(index) === matches[4] && (flag = true);\n              }\n              break;\n            }\n            case \"!=\": {\n              switch (matches[4]) {\n              case \"First\":\n                index !== 0 && (flag = true);\n                break;\n              case \"Last\":\n                index !== (count !== undefined ? count : 0) - 1 &&\n                      (flag = true);\n                break;\n              default:\n                String(index) !== matches[4] && (flag = true);\n              }\n              break;\n            }\n            }\n          }\n          //(index !== 0)\n          else {\n            index && (flag = true);\n            idx = 2;\n          }\n        } else {\n          //indexOf\n          if (matches[1].match(\"{Part}.*\")) {\n            const prop = getProp(matches[1].substring(6), data);\n            if (prop !== undefined) {\n              switch (matches[3]) {\n              case \"==\":\n                String(prop).indexOf(matches[4]) >= 0 && (flag = true);\n                break;\n              case \"!=\":\n                String(prop).indexOf(matches[4]) === -1 && (flag = true);\n                break;\n              }\n            } else {\n              flag = false;\n            }\n          } else {\n            const prop = getProp(matches[1], data);\n            if (prop !== undefined) {\n              //== !=\n              if (matches.length > 3) {\n                switch (matches[3]) {\n                case \"==\":\n                  String(prop) === matches[4] && (flag = true);\n                  break;\n                case \"!=\":\n                  String(prop) !== matches[4] && (flag = true);\n                  break;\n                }\n              }\n              //prop in obj\n              else {\n                flag = true;\n                idx = 2;\n              }\n            } else {\n              flag = false;\n            }\n          }\n        }\n\n        //if \"and\" conditions is present\n        if (\n          flag &&\n          matches[idx].match(\n            /\\{\\{\\s*and\\s*((?:\\{Part\\})?\\w[\\w|.]*)\\s*(([=|!]=)\\s*([\\w:\"]*))?\\s*\\}\\}(.*?)/g\n          )\n        ) {\n          matches[idx] = matches[idx].replace(/\\{\\{s*and/, \"{{if\");\n          matches[idx] += \"{{endif}}\";\n        }\n        template = template.replace(\n          matches[0],\n          flag\n            ? this.fromTemplate(String(matches[idx]), data, index, length)\n            : \"\"\n        );\n      });\n    }\n\n    //{{obj.prop}} or {{prop}}\n    re = /\\{\\{\\s*([\\w|.]*)\\s*\\}\\}/g;\n    finded = [...template.matchAll(re)];\n    if (finded.length) {\n      finded.forEach((matches) => {\n        const prop = getProp(matches[1], data);\n        template = template.replace(matches[0], prop);\n      });\n    }\n    return template;\n  }\n}\n","import { AbstractEvent } from \"./AbstractEvent\";\nimport { AbstractComponent } from \"./AbstractComponent\";\nimport { Templater } from \"./Templater\";\n\nexport class Component<State>\nimplements AbstractComponent<Record<string, unknown>>\n{\n  private _el: HTMLElement;\n  private _state: State;\n  private _events: { [index: string]: AbstractEvent[] };\n  private _template: string;\n  private _templater: Templater;\n  private _firstRender: boolean;\n  private _onMount: ((el: HTMLElement) => void) | null;\n  constructor(\n    el: HTMLElement,\n    hook?: ((el: HTMLElement) => void) | null,\n    initialState?: Partial<State>\n  ) {\n    this._el = el;\n    if (el) {\n      this._template = (this._el as HTMLElement).innerHTML;\n      (this._el as HTMLElement).innerHTML = \"\";\n    } else {\n      this._template = \"\";\n    }\n    this._events = {};\n    this._state = initialState\n      ? Object.assign({}, initialState as State)\n      : ({} as State);\n    this._templater = new Templater();\n    this._onMount = hook || null;\n    this._firstRender = false;\n  }\n\n  subscribeToEvents(evtDest: string, evt: AbstractEvent) {\n    !this._events[evtDest] && (this._events[evtDest] = []);\n    this._events[evtDest].push(evt);\n    this.render();\n  }\n\n  setState(patch: any) {\n    this._state = Object.assign(this._state, patch as State);\n    this.render();\n  }\n\n  render() {\n    if (!this._el) {\n      return null;\n    }\n    if (this._onMount) {\n      !this._firstRender && this._onMount(this._el);\n      this._firstRender = true;\n    }\n\n    let result = this._template.split(\"\\n\").join(\"\\u0000\");\n    result = result.split(\"\\t\").join(\"\\u0001\");\n    result = this._templater.fromTemplate(result, this._state);\n    result = result.split(\"\\u0000\").join(\"\\n\");\n    result = result.split(\"\\u0001\").join(\"\\t\");\n\n    this._el && ((this._el as HTMLElement).innerHTML = result);\n\n    Object.keys(this._events).forEach((key) => {\n      const re = /(\\w+)@(\\w+)\\.(\\w+)/g;\n      const matches = [...key.matchAll(re)];\n      const event = matches[0][1];\n      const el = matches[0][2];\n      const cls = matches[0][3];\n\n      const els = [...this._el.getElementsByClassName(cls)];\n      if (!els.length) {\n        return;\n      }\n      els.forEach((node) => {\n        if (\n          (node as HTMLInputElement).type === el ||\n          (node as HTMLElement).localName === el\n        ) {\n          this._events[key].forEach((evt) => {\n            node.addEventListener(event, evt);\n          });\n        }\n      });\n    });\n    return result;\n  }\n}\n","require(\"./css/style.css\");\nimport { createUI } from \"./ui.js\";\nimport { showLocationInFrame } from \"./forecast.js\";\n\nimport { Component } from \"./Component\";\n\nconst forecastComponent = new Component(\n  document.getElementById(\"#forecast-div-id\") as HTMLElement\n);\nconst mapComponent = new Component(\n  document.getElementById(\"#world-map\") as HTMLElement\n);\nconst searchComponent = new Component(\n  document.getElementById(\"#search-div\") as HTMLElement\n);\nconst historyComponent = new Component(\n  document.getElementById(\"#history-div\") as HTMLElement\n);\n\ndocument.body.onload = createUI(\n  document.getElementById(\"#forecast\") as HTMLElement,\n  showLocationInFrame,\n  searchComponent,\n  forecastComponent,\n  mapComponent,\n  historyComponent\n);\n"]}