parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"zoJ8":[function(require,module,exports) {

},{}],"yc76":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WEATHER_URL_START=exports.WEATHER_URL_END=exports.WEATHER_FETCH_ERR=exports.WEATHER_API_KEY=exports.MY_LOCATION_LON=exports.MY_LOCATION_LAT=exports.MAP_URL_START=exports.MAP_URL_END=exports.MAIN_CONTAINER_ID=exports.LS_CAPACITY=exports.IP_WHOIS_URL=exports.GEOCODER_URL_START=exports.GEOCODER_URL_END=exports.EDIT_ID=exports.CITY_LIST=exports.CBX_ID=exports.BTN_ID=void 0;const t="#forecast";exports.MAIN_CONTAINER_ID="#forecast";const o="#btnId";exports.BTN_ID=o;const s="#edtId";exports.EDIT_ID=s;const e="#cbxId";exports.CBX_ID=e;const _="myLocationLon";exports.MY_LOCATION_LON="myLocationLon";const p="myLocationLat";exports.MY_LOCATION_LAT="myLocationLat";const r="cityList";exports.CITY_LIST=r;const E=10;exports.LS_CAPACITY=10;const T="https://nominatim.openstreetmap.org/search/";exports.GEOCODER_URL_START=T;const x="?format=json&addressdetails=1&limit=1&polygon_svg=1";exports.GEOCODER_URL_END=x;const R="https://www.openstreetmap.org/export/embed.html?bbox=";exports.MAP_URL_START=R;const n="&amp;layer=mapnik";exports.MAP_URL_END=n;const L="542ffd081e67f4512b705f89d2a611b2";exports.WEATHER_API_KEY=L;const A="https://api.openweathermap.org/data/2.5/forecast?lang=ru&units=metric&";exports.WEATHER_URL_START=A;const I="&cnt=24&appid="+L;exports.WEATHER_URL_END=I;const c="https://ipwho.is";exports.IP_WHOIS_URL=c;const a="Ошибка получения данных";exports.WEATHER_FETCH_ERR=a;
},{}],"ZAr9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCoordinates=n,exports.getLocation=o;var e=r(require("./prjConst"));function t(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(t=function(e){return e?n:r})(e)}function r(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=t(r);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e)if("default"!==c&&Object.prototype.hasOwnProperty.call(e,c)){var u=a?Object.getOwnPropertyDescriptor(e,c):null;u&&(u.get||u.set)?Object.defineProperty(o,c,u):o[c]=e[c]}return o.default=e,n&&n.set(e,o),o}async function n(t){let r=await fetch("".concat(e.GEOCODER_URL_START).concat(t).concat(e.GEOCODER_URL_END));return await r.json()}async function o(){let t=await fetch(e.IP_WHOIS_URL);return await t.json()}
},{"./prjConst":"yc76"}],"Rgfk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.edtKeypress=exports.btnClick=exports.aClick=void 0;var e=o(require("./prjConst.js")),t=require("./fetches.js"),r=require("./ui.js");function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function o(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e)if("default"!==c&&Object.prototype.hasOwnProperty.call(e,c)){var s=l?Object.getOwnPropertyDescriptor(e,c):null;s&&(s.get||s.set)?Object.defineProperty(o,c,s):o[c]=e[c]}return o.default=e,r&&r.set(e,o),o}let l=t=>{document.getElementById(e.EDIT_ID).value=t.target.innerHTML,document.getElementById(e.BTN_ID).click()};exports.aClick=l;let c=()=>{let n=document.getElementById(e.EDIT_ID).value;document.getElementById(e.EDIT_ID).value="",(0,t.getCoordinates)(n).then(t=>{let o=t[0].lat,l=t[0].lon,c=localStorage;document.getElementById(e.CBX_ID).checked&&(c.setItem(e.MY_LOCATION_LON,l),c.setItem(e.MY_LOCATION_LAT,o),document.getElementById(e.CBX_ID).checked=!1);let s=c.getItem(e.CITY_LIST),u=s?JSON.parse(s):[],i=!0;for(let e=0;e<u.length;e++)if(u[e].toLowerCase()===n.toLowerCase()){i=!1;break}if(i){u.length===e.LS_CAPACITY&&u.shift(),u.push(n),c.setItem(e.CITY_LIST,JSON.stringify(u));let t=document.getElementById(e.MAIN_CONTAINER_ID);(0,r.addHistoryLink)(n,t.historyComponent,t.history)}let a=document.getElementById(e.MAIN_CONTAINER_ID);a.showFunc(o,l,a.mapComponent,a.forecastComponent)})};exports.btnClick=c;let s=t=>{13===t.keyCode&&document.getElementById(e.BTN_ID).click()};exports.edtKeypress=s;
},{"./prjConst.js":"yc76","./fetches.js":"ZAr9","./ui.js":"Bj9A"}],"Bj9A":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createUI=exports.addHistoryLink=void 0;var e=s(require("./prjConst.js")),t=require("./fetches.js"),r=require("./events.js");function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}function s(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var s={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(s,i,a):s[i]=e[i]}return s.default=e,r&&r.set(e,s),s}let n=(t,r,o)=>{o.cities.length===e.LS_CAPACITY&&o.cities.shift(),o.cities.push(t),r.setState(o)};exports.addHistoryLink=n;let i=(o,s,i,a,c,l)=>{let u={cities:[]};i.subscribeToEvents("click@button.btn",r.btnClick),i.subscribeToEvents("keypress@text.edt",r.edtKeypress),l.subscribeToEvents("click@a.aClass",r.aClick),o.className="main-container",o.id=e.MAIN_CONTAINER_ID,o.showFunc=s,o.mapComponent=c,o.forecastComponent=a,o.historyComponent=l,o.history=u;let p=localStorage,O=p.getItem(e.CITY_LIST);if(O){JSON.parse(O).forEach(e=>{n(e,l,u)})}if(p.getItem(e.MY_LOCATION_LON)){let t=p.getItem(e.MY_LOCATION_LON),r=p.getItem(e.MY_LOCATION_LAT);s(r,t,c,a)}else navigator.geolocation.getCurrentPosition(t=>{let r=t.coords.latitude,o=t.coords.longitude;p.setItem(e.MY_LOCATION_LON,o),p.setItem(e.MY_LOCATION_LAT,r),s(r,o,c,a)},()=>{(0,t.getLocation)().then(t=>{let r=t.latitude,o=t.longitude;p.setItem(e.MY_LOCATION_LON,o),p.setItem(e.MY_LOCATION_LAT,r),s(r,o,c,a)})})};exports.createUI=i;
},{"./prjConst.js":"yc76","./fetches.js":"ZAr9","./events.js":"Rgfk"}],"Mz0O":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.showLocationInFrame=void 0;var t=r(require("./prjConst.js"));function e(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(e=function(t){return t?n:r})(t)}function r(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=e(r);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if("default"!==c&&Object.prototype.hasOwnProperty.call(t,c)){var i=a?Object.getOwnPropertyDescriptor(t,c):null;i&&(i.get||i.set)?Object.defineProperty(o,c,i):o[c]=t[c]}return o.default=t,n&&n.set(t,o),o}async function n(e,r){let n="".concat(t.WEATHER_URL_START,"lat=").concat(e,"&lon=").concat(r).concat(t.WEATHER_URL_END),o=await fetch(n);return o.ok?await o.json():new Promise((t,e)=>{e("-")})}let o=async(e,r,o,a)=>{o.setState({lonS:"".concat(Number(r)-.05),latS:"".concat(Number(e)-.05),lonE:"".concat(Number(r)+.05),latE:"".concat(Number(e)+.05)});try{a.setState(await n(e,r))}catch(c){a.setState({list:[{weather:[{description:"".concat(t.WEATHER_FETCH_ERR)}],main:{temp:"-",humidity:"-"},wind:{speed:"-"}}]})}};exports.showLocationInFrame=o;
},{"./prjConst.js":"yc76"}],"YDzw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Templater=void 0;class e{constructor(){}fromTemplate(e,s,t,r){const a=(e,s)=>{const t=e.split("."),r=s[t[0]];return t.length>1?(t.shift(),a(t.join("."),r)):r};let i=/\{\{\s*for\s*([\w|.]+)\s*as\s*([\w|.]+)\s*\}\}(.*)\{\{\s*endfor\s*\}\}/g,n=[...e.matchAll(i)];if(n.length){const t=n[0],r=a(t[1],s);if(r){const s=r.length,a=r.map((e,r)=>{const a={};return a[String(t[2])]=e,this.fromTemplate(String(t[3]),a,r,s)});e=e.replace(t[0],a.join(" "))}else e=e.replace(t[0],"")}return i=/\{\{\s*if\s*((?:\{Part\})?\w[\w|.]*)\s*(([=|!]=)\s*([\w:"]*))?\s*\}\}(.*?)\{\{\s*endif\s*\}\}/g,(n=[...e.matchAll(i)]).length&&n.forEach(i=>{let n=!1,c=5;if("index"===(i=i.filter(e=>e))[1])if(i.length>3)switch(i[3]){case"==":switch(i[4]){case"First":0===t&&(n=!0);break;case"Last":t===(void 0!==r?r:0)-1&&(n=!0);break;default:String(t)===i[4]&&(n=!0)}break;case"!=":switch(i[4]){case"First":0!==t&&(n=!0);break;case"Last":t!==(void 0!==r?r:0)-1&&(n=!0);break;default:String(t)!==i[4]&&(n=!0)}}else t&&(n=!0),c=2;else if(i[1].match("{Part}.*")){const e=a(i[1].substring(6),s);if(void 0!==e)switch(i[3]){case"==":String(e).indexOf(i[4])>=0&&(n=!0);break;case"!=":-1===String(e).indexOf(i[4])&&(n=!0)}else n=!1}else{const e=a(i[1],s);if(void 0!==e)if(i.length>3)switch(i[3]){case"==":String(e)===i[4]&&(n=!0);break;case"!=":String(e)!==i[4]&&(n=!0)}else n=!0,c=2;else n=!1}n&&i[c].match(/\{\{\s*and\s*((?:\{Part\})?\w[\w|.]*)\s*(([=|!]=)\s*([\w:"]*))?\s*\}\}(.*?)/g)&&(i[c]=i[c].replace(/\{\{s*and/,"{{if"),i[c]+="{{endif}}"),e=e.replace(i[0],n?this.fromTemplate(String(i[c]),s,t,length):"")}),i=/\{\{\s*([\w|.]*)\s*\}\}/g,(n=[...e.matchAll(i)]).length&&n.forEach(t=>{const r=a(t[1],s);e=e.replace(t[0],r)}),e}}exports.Templater=e;
},{}],"QQZF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Component=void 0;const t=require("./Templater");class e{constructor(e,s,i){this._el=e,e?(this._template=this._el.innerHTML,this._el.innerHTML=""):this._template="",this._events={},this._state=i?Object.assign({},i):{},this._templater=new t.Templater,this._onMount=s||null,this._firstRender=!1}subscribeToEvents(t,e){!this._events[t]&&(this._events[t]=[]),this._events[t].push(e),this.render()}setState(t){this._state=Object.assign(this._state,t),this.render()}render(){if(!this._el)return null;this._onMount&&(!this._firstRender&&this._onMount(this._el),this._firstRender=!0);let t=this._template.split("\n").join("\0");return t=t.split("\t").join(""),t=(t=(t=this._templater.fromTemplate(t,this._state)).split("\0").join("\n")).split("").join("\t"),this._el&&(this._el.innerHTML=t),Object.keys(this._events).forEach(t=>{const e=[...t.matchAll(/(\w+)@(\w+)\.(\w+)/g)],s=e[0][1],i=e[0][2],n=e[0][3],r=[...this._el.getElementsByClassName(n)];r.length&&r.forEach(e=>{e.type!==i&&e.localName!==i||this._events[t].forEach(t=>{e.addEventListener(s,t)})})}),t}}exports.Component=e;
},{"./Templater":"YDzw"}],"xQsj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),require("./css/style.css");const e=require("./ui.js"),t=require("./forecast.js"),o=require("./Component"),n=new o.Component(document.getElementById("#forecast-div-id")),d=new o.Component(document.getElementById("#world-map")),r=new o.Component(document.getElementById("#search-div")),m=new o.Component(document.getElementById("#history-div"));document.body.onload=(0,e.createUI)(document.getElementById("#forecast"),t.showLocationInFrame,r,n,d,m);
},{"./css/style.css":"zoJ8","./ui.js":"Bj9A","./forecast.js":"Mz0O","./Component":"QQZF"}]},{},["xQsj"], null)
//# sourceMappingURL=/bundle.914f32c2.js.map